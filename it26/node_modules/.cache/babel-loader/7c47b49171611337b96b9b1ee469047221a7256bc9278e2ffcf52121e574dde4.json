{"ast":null,"code":"import request from \"@/utils/request\";\nimport router from \"@/router\";\nexport default {\n  name: \"HistoryOrder\",\n  components: {},\n  data() {\n    return {\n      search: '',\n      pageSize: 1,\n      currentPage: 4,\n      Dialogrefund: false,\n      total: 10,\n      tableData: [],\n      delid: 0\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      request.get(\"/historyorder/\", {\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize,\n          search: this.search\n        }\n      }).then(res => {\n        console.log(res);\n        this.tableData = res.data;\n        this.total = res.data.total;\n      });\n    },\n    refund(id) {\n      this.Dialogrefund = true;\n      this.delid = JSON.parse(JSON.stringify(id));\n      console.log(this.delid);\n    },\n    confirm() {\n      if (this.form.id) {\n        //Edit\n        request.post(\"/refund/\", this.delid).then(res => {\n          console.log(res);\n          if (res.code === '0') {\n            this.$message({\n              type: \"success\",\n              message: \"Refund Successfully!\"\n            });\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg\n            });\n          }\n          this.load(); //刷新表格内容\n          this.Dialogrefund = false;\n        });\n      }\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    }\n  }\n};","map":{"version":3,"names":["request","router","name","components","data","search","pageSize","currentPage","Dialogrefund","total","tableData","delid","created","load","methods","get","params","pageNum","then","res","console","log","refund","id","JSON","parse","stringify","confirm","form","post","code","$message","type","message","msg","handleSizeChange","handleCurrentChange"],"sources":["/Users/ning/it26/it26/VUE/src/views/Userviews/HistoryOrder.vue"],"sourcesContent":["<template>\n  <!--    OrderTable   -->\n  <div style=\"padding: 10px; width: 100%;\">\n    <!--    <span style=\"font-size: xx-large; font-weight: bold\">History Order</span>-->\n    <!--    Search   -->\n    <div style=\"display: flex\">\n      <div style=\"width: 600px;\">\n        <el-input v-model=\"search\" placeholder=\"Please input Movie name\"  style=\"width: 300px\" clearable />\n        <el-button style=\"margin: 10px\" plain @click=\"load\">Search</el-button>\n      </div>\n    </div>\n\n    <div style=\"padding: 10px;\">\n      <el-table :data=\"tableData \">\n        <el-table-column type=\"index\" align=\"center\" />\n        <el-table-column type=\"expand\" >\n          <template #default=\"props\">\n            <div m=\"4\" style=\"padding: 10px;\">\n              <h3>Description</h3>\n              <p m=\"t-0 b-2\">Movie: {{ props.row.name }}</p>\n              <p m=\"t-0 b-2\">Actor: {{ props.row.actor }}</p>\n              <p m=\"t-0 b-2\">Introduction: {{ props.row.introduction }}</p>\n            </div>\n          </template>\n        </el-table-column>\n\n        <el-table-column label=\"Movie\" prop=\"filmName\" sortable/>\n        <el-table-column label=\"Date\" prop=\"time\" align=\"center\" sortable/>\n        <el-table-column label=\"Position\" prop=\"screen\" align=\"center\" />\n        <el-table-column label=\"Price\" prop=\"price\" align=\"center\"/>\n        <el-table-column label=\"State\" prop=\"state\" align=\"center\"/>\n        <el-table-column label=\"Operations\" align=\"center\" >\n          <template #default=\"scope\">\n            <el-button size=\"small\" type=\"danger\" @click=\"refund(scope.row)\">Refund</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n\n    <div style=\"margin: 10px\">\n      <el-pagination\n          v-model:current-page=\"currentPage\"\n          v-model:page-size=\"pageSize\"\n          :page-sizes=\"[1, 3, 5, 7]\"\n          :small=\"false\"\n          :disabled=\"false\"\n          :background=\"false\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"10\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n      />\n\n      <el-dialog\n          v-model=\"Dialogrefund\"\n          title=\"Tips\"\n          width=\"30%\"\n          align-center\n      >\n        <span>Do you confirm the refund?</span>\n        <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button type=\"primary\" @click=\"confirm\">\n            Confirm\n          </el-button>\n          <el-button @click=\"Dialogrefund = false\">Cancel</el-button>\n        </span>\n        </template>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\nimport request from \"@/utils/request\";\nimport router from \"@/router\";\n\nexport default {\n  name: \"HistoryOrder\",\n\n  components: {},\n  data() {\n    return {\n      search: '',\n      pageSize: 1,\n      currentPage: 4,\n      Dialogrefund: false,\n      total: 10,\n      tableData: [],\n      delid: 0,\n    }\n\n\n  },\n  created() {\n    this.load()\n  },\n\n  methods: {\n    load() {\n      request.get(\"/historyorder/\", {\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize,\n          search: this.search\n        }\n      }).then(res => {\n        console.log(res)\n        this.tableData = res.data\n        this.total = res.data.total\n      })\n    },\n    refund(id) {\n      this.Dialogrefund = true\n      this.delid = JSON.parse(JSON.stringify(id))\n      console.log(this.delid)\n    },\n    confirm()\n    {\n      if(this.form.id) {  //Edit\n        request.post(\"/refund/\", this.delid).then(res => {\n          console.log(res)\n          if (res.code === '0') {\n            this.$message({\n              type: \"success\",\n              message: \"Refund Successfully!\"\n            })\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg,\n            })\n          }\n          this.load()   //刷新表格内容\n          this.Dialogrefund = false\n        })\n      }\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize\n      this.load()\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum\n      this.load()\n    },\n  }\n}\n</script>\n\n<style scoped>\n\n</style>"],"mappings":"AA0EA,OAAOA,OAAM,MAAO,iBAAiB;AACrC,OAAOC,MAAK,MAAO,UAAU;AAE7B,eAAe;EACbC,IAAI,EAAE,cAAc;EAEpBC,UAAU,EAAE,CAAC,CAAC;EACdC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,MAAM,EAAE,EAAE;MACVC,QAAQ,EAAE,CAAC;MACXC,WAAW,EAAE,CAAC;MACdC,YAAY,EAAE,KAAK;MACnBC,KAAK,EAAE,EAAE;MACTC,SAAS,EAAE,EAAE;MACbC,KAAK,EAAE;IACT;EAGF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,IAAI,EAAC;EACZ,CAAC;EAEDC,OAAO,EAAE;IACPD,IAAIA,CAAA,EAAG;MACLb,OAAO,CAACe,GAAG,CAAC,gBAAgB,EAAE;QAC5BC,MAAM,EAAE;UACNC,OAAO,EAAE,IAAI,CAACV,WAAW;UACzBD,QAAQ,EAAE,IAAI,CAACA,QAAQ;UACvBD,MAAM,EAAE,IAAI,CAACA;QACf;MACF,CAAC,CAAC,CAACa,IAAI,CAACC,GAAE,IAAK;QACbC,OAAO,CAACC,GAAG,CAACF,GAAG;QACf,IAAI,CAACT,SAAQ,GAAIS,GAAG,CAACf,IAAG;QACxB,IAAI,CAACK,KAAI,GAAIU,GAAG,CAACf,IAAI,CAACK,KAAI;MAC5B,CAAC;IACH,CAAC;IACDa,MAAMA,CAACC,EAAE,EAAE;MACT,IAAI,CAACf,YAAW,GAAI,IAAG;MACvB,IAAI,CAACG,KAAI,GAAIa,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACH,EAAE,CAAC;MAC1CH,OAAO,CAACC,GAAG,CAAC,IAAI,CAACV,KAAK;IACxB,CAAC;IACDgB,OAAOA,CAAA,EACP;MACE,IAAG,IAAI,CAACC,IAAI,CAACL,EAAE,EAAE;QAAG;QAClBvB,OAAO,CAAC6B,IAAI,CAAC,UAAU,EAAE,IAAI,CAAClB,KAAK,CAAC,CAACO,IAAI,CAACC,GAAE,IAAK;UAC/CC,OAAO,CAACC,GAAG,CAACF,GAAG;UACf,IAAIA,GAAG,CAACW,IAAG,KAAM,GAAG,EAAE;YACpB,IAAI,CAACC,QAAQ,CAAC;cACZC,IAAI,EAAE,SAAS;cACfC,OAAO,EAAE;YACX,CAAC;UACH,OAAO;YACL,IAAI,CAACF,QAAQ,CAAC;cACZC,IAAI,EAAE,OAAO;cACbC,OAAO,EAAEd,GAAG,CAACe;YACf,CAAC;UACH;UACA,IAAI,CAACrB,IAAI,EAAC,EAAI;UACd,IAAI,CAACL,YAAW,GAAI,KAAI;QAC1B,CAAC;MACH;IACF,CAAC;IACD2B,gBAAgBA,CAAC7B,QAAQ,EAAE;MACzB,IAAI,CAACA,QAAO,GAAIA,QAAO;MACvB,IAAI,CAACO,IAAI,EAAC;IACZ,CAAC;IACDuB,mBAAmBA,CAACnB,OAAO,EAAE;MAC3B,IAAI,CAACA,OAAM,GAAIA,OAAM;MACrB,IAAI,CAACJ,IAAI,EAAC;IACZ;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}